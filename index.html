<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS Lesson 7, Task</title>
    <link rel="stylesheet" href="./css/main.css?_v3">
</head>
<body>
<h1>JS Lesson 7, Task</h1>
<h2>Evgenii Rogozhuk</h2>
<div id="container">
    <b>1. Укажите отличия между PHP 5.6 и 7 (как можно больше). Какие из них вы считаете важными и удобными?</b>
    <br />
    <br/>
    <ul>
        <li>
            <code>set_exception_handler()</code> больше не гарантирует получение объекта класса Exception
        </li>
        <li>
            <code>list()</code> больше не присваивает переменные в обратном порядке
        </li>
        <li>
            Пустое присвоение <code>list()</code> больше не разрешено
        </li>
        <li>
            <code>list()</code> не может раскрывать строки
        </li>
        <li>
            Скобки вокруг аргументов функции больше ни на что не влияют
        </li>
        <li>
            <code>foreach</code> больше не изменяет внутренний указатель массива<br/>
            // Считаю важным и удобным<br/><br/>
        </li>
        <li>
            Для <code>foreach</code> по ссылке улучшили поведение при итерации
        </li>
        <li>
            Итерация объектов не реализующих <code>Traversable</code>
        </li>
        <li>
            Изменение в обработке значений типа <code>integer</code>
        </li>
        <li>
            Изменение в делении на ноль
        </li>
        <li>
            Шестнадцатеричные строки больше не считаются за числовые
        </li>
        <li>
            <code>\u{</code> может вызывать ошибки
        </li>
        <li>
            Удаленные директивы <code>INI-файла</code>
        </li>
        <li>
            Новые объекты не могут присваиваться по ссылке
        </li>
        <li>
            Следующие имена нельзя использовать для классов, интерфейсов и трейтов:
            <pre>
                 bool
                int
                float
                string
                NULL
                TRUE
                FALSE
            </pre>
            <br/>
            // Считаю важным<br/><br/>
        </li>
        <li>
            Следующие имена не должны использоваться. Они не приведут к ошибке в PHP 7.0, но они зарезервированы
            на будущее и должны считаться устаревшими.
            <pre>
                resource
                object
                mixed
                numeric
            </pre>
            <br/>
            // Считаю важным<br/><br/>
        </li>
        <li>
            Удалены PHP-теги ASP и script
        </li>
        <li>
            Удалены вызовы из неподходящего контекста
        </li>
        <li>
            <code>yield</code> теперь право-ассоциативный оператор
        </li>
        <li>
            Функции не могут иметь несколько параметров с одинаковыми именами
        </li>
        <li>
            Функции, работающие с аргументами, теперь возвращают их текущие значения
        </li>
        <li>
            Оператор <code>switch</code> больше не может иметь несколько блоков <code>default</code><br/>
            // Считаю важным и удобным<br/><br/>
        </li>
        <li>
            Удалена <code>$HTTP_RAW_POST_DATA</code>
        </li>
        <li>
            Запрещены комментарии # в INI-файлах
        </li>
        <li>
            Расширение <code>JSON</code> заменено на <code>JSOND</code>
        </li>
        <li>
            Изменение порядка обработки операторов <code>break</code> и <code>switch</code>
            Операторы <code>break</code> и <code>continue</code> вне цикла или управляющей структуры
            <code>switch</code> теперь обрабатываются во время компиляции, а не во время выполнения,
            как это было ранее, поэтому выдают ошибки уровня
            <code>E_COMPILE_ERROR</code>.<br/>
            // Считаю важным<br/><br/>
            <br/>
        </li>
        <li>
            <code>Mhash</code> больше не является расширением
        </li>
        <li>
            Директива <code>declare(ticks)</code> больше не проникает в различные модули компиляции
        </li>
        <li>
            Не полностью определенный порт <code>listen</code> теперь слушает как IPv4, так и IPv6
        </li>
        <li>
            Ослабление ограничений на использование зарезервированных слов
        </li>
        <li>
            Удаление предупреждения date.timezone
        </li>
    </ul>
    <br />
    <b>2. Чем отличается <code>__autoload</code> от <code>spl_autoload_register?</code></b>
    <br />
    <br />
    <p>
        <code>__autoload</code> считается устаревшим. Это позволяет использовать только один автозагрузчик.
        Необходимо использовать <code>__autoload</code>, если используется версия PHP без поддержки <code>spl_autload_register</code>.
    </p>
    <p>
        <code>spl_autoload_register</code> позволяет регистрировать несколько автозагрузчиков, которые будут выполняться
        поочередно,
        пока не будет найден и загружен соответствующий класс/интерфейс/признак, или пока все параметры автозагрузки
        не будут исчерпаны. При использовании фрейм-кода или других, сторонних библиотек,
        которые реализуют свои собственные автозагрузчики, все будет работать без конфликтов.
    </p>
    <p>
        Начиная с PHP 7.2.0 <code>__autoload</code> устарел, по этому не следует его использовать.
    </p>
    <br/>
    <b>3. Что такое <code>ECMAScript?</code> Чем он отличается от <code>JavaScript</code>?</b>
    <br />
    <br />
    <b>ECMAScript</b>
    <br />
    <ul>

        <li>ECMAScript является стандартом для языков сценариев.</li>

        <li>Языки, такие как Javascript, основаны на стандарте ECMAScript.</li>

        <li>Стандарт ECMA основан на нескольких исходных технологиях, наиболее известными из которых являются
            JavaScript (Netscape) и JScript (Microsoft).
        </li>

        <li>ECMA означает Европейскую ассоциацию производителей компьютеров</li>
    </ul>
    <b>JavaScript</b>
    <br />
    <ul>
        <li>JavaScript является самой популярной версией стандарта ECMAScript.</li>

        <li>Основные особенности Javascript основаны на стандарте ECMAScript, но Javascript также другие дополнительные
            функции, которые не в спецификации/стандарт ECMA.
        </li>

        <li>ActionScript и JScript - это другие языки, реализующие ECMAScript.</li>

        <li>JavaScript был отправлен в ECMA для стандартизации, но из-за проблем с товарными знаками с именем
            Javascript этот стандарт стал называться ECMAScript.
        </li>

        <li>Каждый браузер имеет интерпретатор JavaScript.</li>
    </ul>
    <br/>
    <b>4. Какие типы БД вы знаете? Приведите примеры.</b>
    <br />
    <br />
    <ul>
        <li>
            Иерархическая - это модель данных, где используется представление базы данных в виде древовидной
            (иерархической) структуры, состоящей из объектов (данных) различных уровней
            Например: Information Management System (IMS) фирмы IBM (1966-1968),
            Time-Shared Date Management System (TDMS) компании System Development Corporation,
            Mark IV MultiAccess Retrieval System компании Control Data Corporation,
            System 2000 разработки SAS Institute,
            InterSystems Cache,
        </li>
        <li>
            Объектная и объектно-ориентированная - база данных, в которой данные моделируются в виде объектов,
            их атрибутов, методов и классов.
            Например: ObjectStore
        </li>
        <li>
            Документо - ориентированная - специально предназначенная для хранения иерархических структур данных
            (документов) и обычно реализуемая с помощью подхода NoSQL
            Например: CouchDB, Couchbase, MarkLogic, MongoDB, eXist, Berkeley DB
        </li>
        <li>
            Объектно-реляционная - реляционная СУБД (РСУБД), поддерживающая некоторые технологии, реализующие
            объектно-ориентированный подход: объекты, классы и наследование реализованы в структуре баз
            данных и языке запросов.
            Например: PostgreSQL
        </li>
        <li>
            Реляционная - логическая модель данных, прикладная теория построения баз данных, которая является
            приложением к задачам обработки данных таких разделов математики, как теория множеств и логика
            первого порядка.
            Например: MySQL
        </li>
        <li>
            Сетевая - логическая модель данных, являющаяся расширением иерархического подхода, строгая математическая
            теория, описывающая структурный аспект, аспект целостности и аспект обработки данных в сетевых
            базах данных
            Например: Cerebrum
        </li>
        <li>
            Функциональная - используются для решения аналитических задач, таких как финансовое моделирование и
            управление производительностью.
            Например: Essbase, TM1, Alea, Microsoft Analysis Services
        </li>
    </ul>
    <br />
    <b>5. Для чего нужны составные индексы в БД?</b>
    <br />
    <br />
    <p>
        Такие индексы имеет смысл использовать, когда в одном запросе фигурируют более одной колонки.
        Mysql поддерживает составные индексы для любых типов таблиц.
    </p>
    <br/>
    <b>6. Практическая задача.</b><br/>
    <b>Спроектируйте систему новостной ленты по указанным требованиям (нужно создать схему БД, указать необходимые
        индексы, перечислить стек технологий):</b>
    <ul>
        <li>Лента новостей выводится по убыванию: от самой свежей новости к более давним;</li>
        <li>Каждая новость снабжена лентой комментариев;</li>
        <li>Лента комментариев выводится по возрастанию: от самого давнего комментария к новым;</li>
        <li>Обе ленты (новостей и комментариев) имеют функционал пагинации: новости – по 10 единиц, комментарии – по
            25;
        </li>
        <li>Комментарии могут оставлять только авторизованные пользователи;</li>
        <li>Новостей и комментариев может быть очень много.</li>
    </ul>
    <b>* Усложнение задачи 6:</b><br/>
    <ul>
        <li>
            6.1 Напишите запрос, который будет отвечать за пагинацию новостей или комментариев.
        </li>
        <li>
            6.2 Где лучше сортировать выводимые данные – на уровне БД или логики? Почему?
        </li>
        <li>
            6.3 Сверстайте прототип ленты новостей (без поддержки логики, с AJAX-заглушками).
        </li>
    </ul>
    <br />
    <br />
    <b>РЕШЕНИЕ</b>
    <br />
    <br />
    Стек
    <ul>
        <li>MySQL основная БД</li>
        <li>PHP - backend и API / framework YII2</li>
        <li>PHP-FPM - интерпретатор</li>
        <li>NGINX - сервер HTTP-запросов</li>
        <li>Redis - кеширование</li>
        <li>JS - frontend / framework React</li>
        <li>NODE.JS - рендеринг сервер</li>
    </ul>
    <img src="./img/map.png" alt="map" width="100%"/>
    <b>Как происходит связь: </b><br/><br/>
    <p>
        Таблица `news` имеет связь с `comments` по средством таблицы связей `news_comments`, что дает возможность
        обращения многих ко многим `news_comments`.`news_id` => `news`.`id` и `news_comments`.`comment_id` =>
        `comments`.`id`.
        У новости PRIMARY index ID у комментария PRIMARY index ID, в таблице связей имеются Foreign Keys это news_id -
        `db`.`news` и comment_id - `db`.`comments`
    </p>
    <p>
        В схеме также имеется таблица `users` она отвечает за пользователей, котрые оставляют комментарии и могут иметь
        различные роли, которые прописываются в модели и имеют свою константу, так как у пользователя не может быть
        мульти комментариев
        они связываются с таблицей `comments` на прямую через связь `user`.`id` => `comments`.`user_id`
    </p>
    <p>
        Возможность комментирования происходит за счет пользователей и доступных ролей. В виду того, что у пользователя
        может
        быть несколько ролей, необходимо воспользоваться мульти связью через таблицу связей `user_roles`, где
        связь `users` и `roles` осуществляются за счет `user_roles`.`user_id` => `user`.`id` и `user_roles`.`role_id` =>
        `roles`.`id`
        в таблице связей имеются Foreign Keys это user_id - `db`.`users` и role_id - `db`.`roles`
        Таблицы имеют PRIMARY KEY `users` index ID и `roles` index ID
    </p>
    <p>
        Вывод новостей будет осуществляться по колонке `time_create` DESC. Почему не по `id`, так как при необходимости
        сменить
        положение новости нельзя сменить ID так как он PRIMARY KEY и назнаяается БД, а `time_create` возможно поменять.
        В контроллере на PHP прописывается пагинация 10 шт.
        Подгрузка происходит через запрос POST отправляемый frontend
    </p>
    <p>
        Вывод комментариев будет осуществляться по колонке `id` ASC. В контроллере на PHP прописывается пагинация 25 шт.
        Подгрузка происходит через запрос POST отправляемый frontend
    </p>
    <p>
        Возможность комментирования осуществляется за счет регистрации и получения необходимой роли. Роли также можно
        пере/до назначить из административной панели.
    </p>
    <b>6.1</b><br />
    <p>
        Вывод новостей
    </p>
    <pre>
        SELECT * FROM `news` ORDER BY `time_create` DESC LIMIT 10;
    </pre>
    <p>
        Вывод новостей при следующей пагинации
    </p>
    <pre>
        // где 20 - смещение, 10 - количество записей на странице
        SELECT * FROM `news` ORDER BY `time_create` DESC LIMIT 20, 10
    </pre>
    <p>
        Вывод комментариев
    </p>
    <pre>
        SELECT * FROM `comments` ORDER BY `id` ASC LIMIT 25;
    </pre>
    <p>
        Вывод комментариев при следующей пагинации
    </p>
    <pre>
         // где 50 - смещение, 25 - количество записей на странице
        SELECT * FROM `comments` ORDER BY `time_create` ASC LIMIT 50, 25
    </pre>
    <b>6.2</b><br />
    <p>
        Сортировку лучше производить на стороне БД, это будет гораздо быстрее, чем извлекать все
        поля и сортировать их на frontend. Все это становится возможным благодаря индексированию БД.
        <br />
        <br />
        P.S. Сортировать на frontend возможно только небольшие данные, передавая через API все поля и реализуя через
        JS и AJAX пагинацию на стороне клиента, конечно в таком случае для пользователя это будет происходить
        моментально.
    </p>
    <b>6.3</b><br />
    <p>
        <a href="./news.html" class="btn btn-success text-center">Страница новостей</a>
    </p>
    <b>
        * Надо обеспечить хранение большого списка файлов в системе CentOS. Как организовать структуру директорий?
    </b>
    <p>
        1) Такие решения необходимо продумывать до начала создания проекта, так как в дальнейшем это будет сложно
        переделать.<br />
        2) Рекомендуется сохранять любое количество файлов в разных папках от 2-3 и более.<br />
        3) Если файлов очень много, то лучше выделить для них отдельный сервер и хранить их под именем в hash.<br />
        Хранить такие файлы можно, как вариант, в папках созданных на основе первых 2-3 букв имени файла.<br />
        Например файл <code>78r9uy776yyhg54568mjhf.doc</code> будет лежать по адресу <code>../7/8/r/</code>
    </p>
</div>
</body>
</html>
